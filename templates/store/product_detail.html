{% extends "base.html" %}
{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/product_detail.css' %}">
<div class="container">
    <div class="image-container">
        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="img-fluid">
    </div>
    <div class="details-container">
        <div class="product-detail">
            <h2>{{ product.name }}</h2>
            <p class="product-description">{{ product.description }}</p>
            <p style="margin: 0;">Price: {{ product.price }}</p>
            <p>Stock: {{ product.stock }}</p>
            <hr style="width: 50%;">
            <small>Material: {{ product.material }} | Print Time: {{ product.print_time }}hrs | Infill:
                {{ product.infill }}%<br>
                Printer: {{ product.printer_type }}</small>
        </div>
        <form method="post"
            action="{% url 'store:cart_add' category_slug=product.category.slug product_slug=product.slug %}">
            {% csrf_token %}
            <div class="form-group">
                <label for="quantity">Quantity:</label>
                <div class="quantity-input">
                    <button type="button" id="minus" class="quantity-button">-</button>
                    <input type="number" name="quantity" id="quantity" value="1" min="1" max="{{ product.stock }}"
                        class="form-control quantity-field">
                    <button type="button" id="plus" class="quantity-button">+</button>
                </div>
            </div>

            <button type="submit" class="addtocart-btn">
                <div class="tooltip-wrapper">
                    <div class="tooltip">ADD TO CART</div>
                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="35pt" height="35pt"
                        viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">

                        <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000"
                            stroke="none">
                            <path d="M2414 5106 c-79 -18 -169 -55 -241 -97 -56 -34 -176 -143 -205 -187
-15 -22 -37 -25 -509 -82 -272 -32 -502 -62 -512 -65 -10 -4 -24 -20 -32 -36
-13 -25 -11 -57 20 -321 19 -161 35 -301 35 -310 0 -15 -9 -18 -44 -18 -27 0
-52 -7 -65 -17 -12 -10 -83 -119 -158 -243 l-136 -225 -88 -1695 c-48 -932
-88 -1708 -89 -1723 0 -19 10 -39 29 -58 l29 -29 2112 0 2112 0 29 29 c19 19
29 39 29 58 -1 15 -41 791 -89 1723 l-88 1695 -136 225 c-75 124 -146 233
-158 243 -17 13 -40 17 -111 17 -80 0 -89 2 -84 18 18 60 56 239 56 266 0 25
-28 74 -43 76 -1 0 -180 42 -397 93 l-395 93 -21 66 c-76 234 -258 412 -499
488 -90 28 -264 36 -351 16z m295 -182 c96 -27 172 -73 247 -148 61 -61 124
-155 124 -184 0 -5 -44 1 -97 14 -184 44 -196 37 -237 -141 -64 -277 -57 -258
-100 -268 -21 -5 -41 -6 -45 -1 -4 5 -23 140 -41 299 -18 160 -39 302 -46 316
-21 42 -58 49 -176 33 -56 -7 -107 -13 -113 -13 -21 -1 83 57 141 78 116 43
227 47 343 15z m-315 -501 c15 -137 30 -255 32 -264 3 -13 -68 -33 -408 -114
-365 -88 -416 -103 -440 -126 -16 -15 -28 -36 -28 -46 0 -11 16 -83 35 -162
19 -78 35 -144 35 -147 0 -2 -94 -4 -209 -4 l-209 0 -5 33 c-18 98 -109 918
-104 924 7 6 1179 150 1243 152 l30 1 28 -247z m1034 -99 c274 -64 499 -118
500 -119 2 -2 -30 -147 -71 -322 l-74 -318 -251 -3 -251 -2 -10 37 c-6 21 -42
171 -81 333 -39 162 -78 305 -86 318 -25 39 -56 44 -144 23 -92 -21 -88 -26
-64 77 20 87 22 92 30 92 3 0 229 -52 502 -116z m-397 -477 c31 -131 60 -249
63 -262 l6 -25 -649 0 -650 0 -10 38 c-6 20 -19 74 -29 119 l-19 82 291 71
c160 38 428 104 596 144 168 41 314 74 325 73 17 -2 27 -32 76 -240z m-2024
-132 c6 -55 12 -112 12 -127 l1 -28 -105 0 c-58 0 -105 2 -105 4 0 3 34 62 76
131 95 158 104 159 121 20z m3227 -21 c42 -69 76 -127 76 -130 0 -2 -79 -4
-176 -4 -162 0 -175 1 -170 18 3 9 17 68 31 130 l27 112 68 0 69 0 75 -126z
m156 -346 c0 -18 36 -733 80 -1588 44 -855 80 -1563 80 -1572 0 -17 -101 -18
-1990 -18 -1889 0 -1990 1 -1990 18 0 9 36 717 80 1572 44 855 80 1570 80
1588 l0 32 1830 0 1830 0 0 -32z" />
                            <path d="M1810 3190 c-136 -64 -197 -216 -136 -345 23 -51 88 -118 124 -129
19 -6 20 -18 25 -229 5 -241 13 -289 68 -406 101 -217 289 -367 521 -415 380
-78 748 147 859 526 18 62 22 107 26 295 5 211 6 223 25 229 33 10 98 74 120
118 90 176 -55 391 -250 373 -130 -11 -226 -105 -239 -232 -10 -97 46 -204
131 -250 l36 -20 0 -200 c0 -226 -8 -276 -66 -385 -65 -124 -188 -226 -326
-271 -250 -81 -539 37 -662 271 -58 109 -66 159 -66 385 l0 200 36 20 c50 27
100 89 120 148 39 118 -17 250 -131 309 -60 31 -158 34 -215 8z m139 -165 c31
-16 53 -62 44 -94 -5 -21 -5 -21 -30 -1 -33 26 -73 25 -106 0 -25 -20 -26 -20
-32 -1 -10 33 6 72 39 92 37 23 49 23 85 4z m1300 0 c33 -16 56 -64 46 -94
l-6 -21 -26 20 c-30 24 -80 26 -110 5 -18 -13 -22 -13 -27 0 -9 24 15 75 43
90 33 18 46 18 80 0z" />
                        </g>
                    </svg>
                </div>
            </button>
        </form>
        {% if user.is_authenticated %}
        <form method="post" action="{% url 'store:wishlist_add' product.category.slug product.slug %}">
            {% csrf_token %}
            <button type="submit" id="addToWishlist" onclick="showMessagePopup()" class="addtocart-btn wishlist-btn">
                <div class="tooltip-wrapper">
                    <div class="tooltip" style="left: -120px;">ADD TO WISHLIST</div>
                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="35pt" height="35pt"
                        viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">

                        <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000"
                            stroke="none">
                            <path d="M1325 4484 c-356 -64 -657 -273 -840 -584 -201 -344 -216 -787 -38
-1145 84 -167 88 -172 1072 -1158 520 -522 958 -955 973 -963 35 -18 101 -18
136 0 15 8 453 441 973 963 984 986 988 991 1072 1158 127 255 158 565 86 841
-140 535 -616 904 -1166 904 -191 0 -353 -36 -520 -115 -136 -64 -232 -135
-381 -279 l-132 -129 -133 130 c-144 142 -242 213 -381 279 -219 103 -487 140
-721 98z m440 -333 c189 -54 280 -116 525 -357 280 -275 258 -276 550 9 218
214 279 259 423 316 120 47 171 56 327 56 167 0 236 -15 366 -75 249 -115 424
-322 495 -585 17 -63 22 -109 23 -220 0 -153 -12 -218 -65 -348 -65 -158 -85
-179 -993 -1087 l-856 -855 -846 845 c-465 465 -868 874 -896 910 -63 82 -120
201 -150 310 -31 118 -31 327 1 445 90 333 350 578 691 651 94 20 313 12 405
-15z" />
                        </g>
                    </svg>
                </div>
            </button>
        </form>
        {% endif %}
    </div>
</div>
<script>
    document.getElementById('minus').addEventListener('click', function () {
        const quantityInput = document.getElementById('quantity');
        const currentValue = parseInt(quantityInput.value);
        if (currentValue > parseInt(quantityInput.min)) {
            quantityInput.value = currentValue - 1;
        }
    });

    document.getElementById('plus').addEventListener('click', function () {
        const quantityInput = document.getElementById('quantity');
        const currentValue = parseInt(quantityInput.value);
        const maxStock = parseInt(quantityInput.getAttribute('max'));
        if (currentValue < maxStock) {
            quantityInput.value = currentValue + 1;
        }
    });
</script>
{% endblock %}